<!doctype html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabuleiro Imersivo - Educa√ß√£o Sexual</title>
    <script src="/_sdk/element_sdk.js"></script>
    <style>
        body { box-sizing: border-box; margin: 0; padding: 20px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: transparent; min-height: 100%; color: #333; overflow-x: auto; position: relative; }
        .bubbles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        .bubble { position: absolute; border-radius: 50%; opacity: 0.6; animation: float 6s ease-in-out infinite; }
        .bubble:nth-child(1) { width: 40px; height: 40px; background: linear-gradient(135deg, #ff6b6b, #ee5a52); left: 10%; animation-delay: 0s; }
        .bubble:nth-child(2) { width: 60px; height: 60px; background: linear-gradient(135deg, #4ecdc4, #44a08d); left: 20%; animation-delay: 2s; }
        .bubble:nth-child(3) { width: 30px; height: 30px; background: linear-gradient(135deg, #45b7d1, #96c93d); left: 35%; animation-delay: 4s; }
        .bubble:nth-child(4) { width: 50px; height: 50px; background: linear-gradient(135deg, #96ceb4, #feca57); left: 50%; animation-delay: 0s; }
        .bubble:nth-child(5) { width: 35px; height: 35px; background: linear-gradient(135deg, #feca57, #ff9ff3); left: 70%; animation-delay: 3s; }
        .bubble:nth-child(6) { width: 45px; height: 45px; background: linear-gradient(135deg, #ff9ff3, #667eea); left: 80%; animation-delay: 5s; }
        @keyframes float { 0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; } 10% { opacity: 0.6; } 90% { opacity: 0.6; } 50% { transform: translateY(-10vh) rotate(180deg); opacity: 0.8; } }
        /* Efeitos Visuais de √Åudio */
        .music-button { position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #667eea,#764ba2); color: white; border: none; padding: 15px 20px; border-radius: 25px; font-size: 1.1rem; font-weight: bold; cursor: pointer; box-shadow: 0 8px 16px rgba(0,0,0,0.2); transition: all 0.3s ease; z-index: 1000; }
        .music-button:hover { transform: translateY(-2px); box-shadow: 0 12px 24px rgba(0,0,0,0.3); }
        .music-button.playing { animation: music-pulse 2s infinite; }
        @keyframes music-pulse { 0%, 100% { box-shadow: 0 8px 16px rgba(0,0,0,0.2), 0 0 0 0 rgba(102, 126, 234, 0.7); } 50% { box-shadow: 0 8px 16px rgba(0,0,0,0.2), 0 0 0 15px rgba(102, 126, 234, 0); } }
        .sound-waves { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2000; }
        .sound-wave { position: absolute; border: 3px solid; border-radius: 50%; animation: sound-wave-expand 1.5s ease-out forwards; }
        @keyframes sound-wave-expand { 0% { width: 20px; height: 20px; opacity: 1; } 100% { width: 300px; height: 300px; opacity: 0; } }
        .dice-visual-effect { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 4rem; z-index: 2500; pointer-events: none; animation: dice-bounce 1s ease-out forwards; }
        @keyframes dice-bounce { 0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 0; } 20% { transform: translate(-50%, -50%) scale(1.3) rotate(90deg); opacity: 1; } 40% { transform: translate(-50%, -50%) scale(0.8) rotate(180deg); opacity: 1; } 60% { transform: translate(-50%, -50%) scale(1.1) rotate(270deg); opacity: 1; } 80% { transform: translate(-50%, -50%) scale(0.9) rotate(360deg); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(0) rotate(450deg); opacity: 0; } }
        .move-trail { position: absolute; width: 8px; height: 8px; background: radial-gradient(circle, #4299e1, #3182ce, transparent); border-radius: 50%; animation: move-trail-fade 1s ease-out forwards; z-index: 15; }
        @keyframes move-trail-fade { 0% { transform: scale(1); opacity: 1; box-shadow: 0 0 15px #4299e1; } 50% { transform: scale(1.5); opacity: 0.7; box-shadow: 0 0 25px #4299e1; } 100% { transform: scale(0); opacity: 0; box-shadow: 0 0 5px #4299e1; } }
        .coin-visual-effect { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 5rem; z-index: 2600; pointer-events: none; animation: coin-spin 2s ease-out forwards; text-shadow: 0 0 20px rgba(255, 215, 0, 0.9); }
        @keyframes coin-spin { 0% { transform: translate(-50%, -50%) scale(0) rotateY(0deg); opacity: 0; } 15% { transform: translate(-50%, -50%) scale(1.5) rotateY(180deg); opacity: 1; } 30% { transform: translate(-50%, -50%) scale(1) rotateY(360deg); opacity: 1; } 45% { transform: translate(-50%, -50%) scale(1.3) rotateY(540deg); opacity: 1; } 60% { transform: translate(-50%, -50%) scale(0.8) rotateY(720deg); opacity: 1; } 75% { transform: translate(-50%, -50%) scale(1.1) rotateY(900deg); opacity: 1; } 90% { transform: translate(-50%, -50%) scale(0.9) rotateY(1080deg); opacity: 0.7; } 100% { transform: translate(-50%, -50%) scale(0) rotateY(1260deg); opacity: 0; } }
        .error-visual-effect { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 5rem; z-index: 2600; pointer-events: none; animation: error-shake 1.5s ease-out forwards; text-shadow: 0 0 20px rgba(255, 69, 0, 0.9); }
        @keyframes error-shake { 0% { transform: translate(-50%, -50%) scale(0); opacity: 0; } 10% { transform: translate(-50%, -50%) scale(1.3); opacity: 1; } 15% { transform: translate(-45%, -50%) scale(1.2); opacity: 1; } 25% { transform: translate(-55%, -50%) scale(1.1); opacity: 1; } 35% { transform: translate(-48%,-50%) scale(1.2); opacity: 1; } 45% { transform: translate(-52%, -50%) scale(1.1); opacity: 1; } 55% { transform: translate(-49%, -50%) scale(1.15); opacity: 1; } 65% { transform: translate(-51%, -50%) scale(1.05); opacity: 1; } 75% { transform: translate(-50%, -50%) scale(1); opacity: 0.8; } 85% { transform: translate(-50%, -50%) scale(0.8); opacity: 0.5; } 100% { transform: translate(-50%, -50%) scale(0); opacity: 0; } }
        .victory-visual-effect { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 6rem; z-index: 2700; pointer-events: none; animation: victory-celebration 3s ease-out forwards; text-shadow: 0 0 30px rgba(255, 215, 0, 1); }
        @keyframes victory-celebration { 0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 0; } 15% { transform: translate(-50%, -50%) scale(1.5) rotate(72deg); opacity: 1; } 30% { transform: translate(-50%, -50%) scale(1.2) rotate(144deg); opacity: 1; } 45% { transform: translate(-50%, -50%) scale(1.4) rotate(216deg); opacity: 1; } 60% { transform: translate(-50%, -50%) scale(1.1) rotate(288deg); opacity: 1; } 75% { transform: translate(-50%, -50%) scale(1.3) rotate(360deg); opacity: 1; } 85% { transform: translate(-50%, -50%) scale(1) rotate(432deg); opacity: 0.8; } 95% { transform: translate(-50%, -50%) scale(0.7) rotate(504deg); opacity: 0.4; } 100% { transform: translate(-50%, -50%) scale(0) rotate(576deg); opacity: 0; } }
        .roulette-glow { animation: roulette-glow-pulse 0.5s ease-in-out; }
        @keyframes roulette-glow-pulse { 0% { box-shadow: 0 15px 35px rgba(0,0,0,0.2); } 50% { box-shadow: 0 15px 35px rgba(0,0,0,0.2), 0 0 30px rgba(255, 215, 0, 0.8); } 100% { box-shadow: 0 15px 35px rgba(0,0,0,0.2); } }
        .player-move-glow { animation: player-move-glow 1s ease-out; }
        @keyframes player-move-glow { 0% { box-shadow: 0 3px 6px rgba(0,0,0,0.4); } 50% { box-shadow: 0 3px 6px rgba(0,0,0,0.4), 0 0 20px rgba(66, 153, 225, 0.8); } 100% { box-shadow: 0 3px 6px rgba(0,0,0,0.4); } }
        .game-container { max-width: 1200px; margin: 0 auto; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 25px; padding: 30px; box-shadow: 0 25px 50px rgba(0,0,0,0.1); border: 2px solid rgba(255, 255, 255, 0.2); }
        .game-header { text-align: center; margin-bottom: 30px; }
        .game-title { font-size: 2.8rem; font-weight: bold; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
        .instructions { font-size: 1.2rem; color: #4a5568; margin-bottom: 20px; font-weight: 500; }
        .players-info { display: flex; justify-content: space-between; margin-bottom: 30px; gap: 20px; }
        .player-card { flex: 1; background: linear-gradient(135deg, #4299e1, #3182ce); color: white; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 8px 16px rgba(0,0,0,0.1); border: 2px solid transparent; transition: all 0.3s ease; }
        .player-card.active { border-color: #ffd700; box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); transform: scale(1.05); }
        .player-card.player2 { background: linear-gradient(135deg, #e53e3e, #c53030); }
        .player-name { font-size: 1.3rem; font-weight: bold; margin-bottom: 10px; }
        .player-stats { display: flex; justify-content: space-around; margin-top: 15px; }
        .stat { display: flex; align-items: center; gap: 5px; font-size: 1.1rem; }
        .coins { color: #ffd700; }
        .bombs { color: #ff6b6b; }
        .board-container { position: relative; margin: 30px 0; display: flex; flex-direction: column; align-items: center; gap: 40px; overflow: visible; min-height: 700px; }
        .board { display: grid; grid-template-columns: repeat(8, 1fr); gap: 15px; background: transparent; padding: 40px; border-radius: 50%; width: 600px; height: 600px; position: relative; justify-content: center; align-items: center; overflow: visible; contain: layout; }
        .square { width: 80px; height: 100px; border: 3px solid rgba(255, 255, 255, 0.8); border-radius: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-weight: bold; font-size: 0.7rem; cursor: pointer; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: absolute; text-align: center; backdrop-filter: blur(8px); box-shadow: 0 8px 32px rgba(0,0,0,0.15); animation: float-gentle 3s ease-in-out infinite; overflow: visible; background: white; }
        .character-card { position: absolute; top: -80px; left: 50%; transform: translateX(-50%); width: 120px; height: 140px; background: white; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 50; border: 3px solid #4299e1; animation: cardAppear 0.5s ease-out; pointer-events: none; }
        .character-card.show { display: flex; }
        .character-card.happy { border-color: #48bb78; background: linear-gradient(135deg, #f0fff4, #c6f6d5); }
        .character-card.sad { border-color: #e53e3e; background: linear-gradient(135deg, #fff5f5, #fed7d7); }
        @keyframes cardAppear { 0% { transform: translateX(-50%) scale(0) rotate(180deg); opacity: 0; } 100% { transform: translateX(-50%) scale(1) rotate(0deg); opacity: 1; } }
        .character-avatar { width: 60px; height: 60px; border-radius: 50%; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; transition: all 0.3s ease; background-size: cover; background-position: center; background-repeat: no-repeat; }
        .character-avatar.has-image { font-size: 0; }
        .character-avatar.happy { background: linear-gradient(135deg, #48bb78, #38a169); animation: bounce 0.6s ease-in-out; }
        .character-avatar.sad { background: linear-gradient(135deg, #e53e3e, #c53030); animation: shake 0.6s ease-in-out; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .explosion-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, rgba(255,69,0,0.8) 0%, rgba(255,140,0,0.6) 30%, rgba(255,215,0,0.4) 60%, transparent 100%); z-index: 2000; display: none; animation: explode 1.5s ease-out; pointer-events: none; }
        @keyframes explode { 0% { transform: scale(0); opacity: 0; } 20% { transform: scale(0.5); opacity: 1; } 50% { transform: scale(1.2); opacity: 0.8; } 100% { transform: scale(3); opacity: 0; } }
        .explosion-particles { position: fixed; top: 50%; left: 50%; width: 10px; height: 10px; pointer-events: none; z-index: 2001; }
        .particle { position: absolute; width: 8px; height: 8px; background: #ff4500; border-radius: 50%; animation: particle-explosion 1.5s ease-out forwards; }
        @keyframes particle-explosion { 0% { transform: translate(0, 0) scale(1); opacity: 1; } 100% { opacity: 0; transform: translate(var(--end-x, 100px), var(--end-y, 100px)) scale(0); } }
        .screen-shake { animation: screen-shake 0.8s ease-in-out; }
        @keyframes screen-shake { 0%, 100% { transform: translateX(0); } 10% { transform: translateX(-10px) translateY(-5px); } 20% { transform: translateX(10px) translateY(5px); } 30% { transform: translateX(-8px) translateY(-3px); } 40% { transform: translateX(8px) translateY(3px); } 50% { transform: translateX(-6px) translateY(-2px); } 60% { transform: translateX(6px) translateY(2px); } 70% { transform: translateX(-4px) translateY(-1px); } 80% { transform: translateX(4px) translateY(1px); } 90% { transform: translateX(-2px); } }
        .stars-celebration { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2500; }
        .dancing-star { position: absolute; font-size: 2.5rem; animation: star-dance 2.5s ease-in-out forwards; text-shadow: 0 0 15px rgba(255, 215, 0, 0.9); filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.7)); }
        @keyframes star-dance { 0% { transform: scale(0) rotate(0deg); opacity: 0; } 15% { transform: scale(1.3) rotate(72deg); opacity: 1; } 30% { transform: scale(0.7) rotate(144deg); opacity: 1; } 45% { transform: scale(1.1) rotate(216deg); opacity: 1; } 60% { transform: scale(0.9) rotate(288deg); opacity: 1; } 75% { transform: scale(1.2) rotate(360deg); opacity: 1; } 90% { transform: scale(0.8) rotate(432deg); opacity: 0.7; } 100% { transform: scale(0) rotate(504deg); opacity: 0; } }
        .star-trail { position: absolute; width: 4px; height: 4px; background: radial-gradient(circle, #ffd700, #ffed4e, transparent); border-radius: 50%; animation: trail-sparkle 2s ease-out forwards; }
        @keyframes trail-sparkle { 0% { transform: scale(1); opacity: 1; box-shadow: 0 0 10px #ffd700; } 50% { transform: scale(1.5); opacity: 0.8; box-shadow: 0 0 20px #ffd700; } 100% { transform: scale(0); opacity: 0; box-shadow: 0 0 5px #ffd700; } }
        .flying-comet { position: absolute; font-size: 2rem; animation: comet-flight 3s ease-in-out forwards; text-shadow: 0 0 20px rgba(255, 140, 0, 0.9); filter: drop-shadow(0 0 10px rgba(255, 69, 0, 0.8)); z-index: 2600; }
        @keyframes comet-flight { 0% { transform: scale(0.5) rotate(0deg); opacity: 0; } 10% { transform: scale(1) rotate(45deg); opacity: 1; } 90% { transform: scale(1.2) rotate(405deg); opacity: 1; left: var(--end-x); top: var(--end-y); } 100% { transform: scale(0) rotate(450deg); opacity: 0; left: var(--end-x); top: var(--end-y); } }
        .comet-trail { position: absolute; width: 3px; height: 60px; background: linear-gradient(to bottom, rgba(255, 140, 0, 0.9) 0%, rgba(255, 69, 0, 0.7) 30%, rgba(255, 215, 0, 0.5) 60%, transparent 100%); border-radius: 50px; animation: comet-trail-flight 3s ease-in-out forwards; transform-origin: center top; z-index: 2550; }
        @keyframes comet-trail-flight { 0% { transform: scale(0) rotate(0deg); opacity: 0; } 10% { transform: scale(1) rotate(45deg); opacity: 0.8; } 90% { transform: scale(1.5) rotate(405deg); opacity: 0.6; left: var(--trail-end-x); top: var(--trail-end-y); } 100% { transform: scale(0) rotate(450deg); opacity: 0; left: var(--trail-end-x); top: var(--trail-end-y); } }
        .character-message { font-size: 0.8rem; font-weight: bold; text-align: center; color: #4a5568; margin-top: 5px; }
        .character-message.happy { color: #2f855a; }
        .character-message.sad { color: #c53030; }
        .square:hover { transform: scale(1.1) translateY(-5px); box-shadow: 0 15px 35px rgba(0,0,0,0.3); border-color: rgba(255, 215, 0, 0.8); }
        .square-character { font-size: 2.5rem; margin-bottom: 5px; filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2)); }
        .square-number { font-size: 0.8rem; font-weight: bold; color: #4a5568; background: rgba(255, 255, 255, 0.9); padding: 2px 6px; border-radius: 8px; margin-top: 2px; }
        @keyframes float-gentle { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-8px); } }
        .square.normal { background: linear-gradient(135deg, #e8f5e8, #c6f6d5); border-color: rgba(72, 187, 120, 0.8); }
        .square.vf { background: linear-gradient(135deg, #fff5e6, #fed7aa); border-color: rgba(237, 137, 54, 0.8); }
        .square.start { background: linear-gradient(135deg, #e6f3ff, #bee3f8); border-color: rgba(66, 153, 225, 0.8); width: 90px; height: 110px; }
        .square.finish { background: linear-gradient(135deg, #f0e6ff, #e9d8fd); border-color: rgba(159, 122, 234, 0.8); width: 90px; height: 110px; animation: pulse-float 2s infinite, float-gentle 3s ease-in-out infinite; }
        @keyframes pulse-float { 0%, 100% { box-shadow: 0 0 0 0 rgba(159, 122, 234, 0.7); transform: scale(1); } 50% { box-shadow: 0 0 0 15px rgba(159, 122, 234, 0); transform: scale(1.1); } }
        .player { position: absolute; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; top: -10px; z-index: 10; box-shadow: 0 3px 6px rgba(0,0,0,0.4); display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: bold; color: white; }
        .player.player1 { background: linear-gradient(135deg, #4299e1, #3182ce); right: -10px; }
        .player.player2 { background: linear-gradient(135deg, #e53e3e, #c53030); right: -30px; }
        .roulette-container { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: flex; flex-direction: column; align-items: center; gap: 20px; z-index: 10; }
        .roulette { width: 180px; height: 180px; border-radius: 50%; background: conic-gradient( #ff6b6b 0deg 60deg, #4ecdc4 60deg 120deg, #45b7d1 120deg 180deg, #96ceb4 180deg 240deg, #feca57 240deg 300deg, #ff9ff3 300deg 360deg ); border: 8px solid rgba(255, 255, 255, 0.9); box-shadow: 0 15px 35px rgba(0,0,0,0.2); cursor: pointer; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(10px); }
        .roulette:hover { transform: scale(1.05); box-shadow: 0 12px 24px rgba(0,0,0,0.4); }
        .roulette.spinning { animation: spin 2s ease-out; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(1800deg); } }
        .roulette-center { width: 60px; height: 60px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold; color: #4a5568; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .roulette-pointer { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid #ffd700; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
        .controls { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 30px 0; }
        .turn-indicator { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 15px 30px; border-radius: 25px; font-size: 1.2rem; font-weight: bold; box-shadow: 0 8px 16px rgba(0,0,0,0.2); text-align: center; min-width: 200px; }
        .game-info { display: flex; justify-content: center; align-items: center; background: linear-gradient(135deg, #edf2f7, #e2e8f0); padding: 20px; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .winner-announcement { background: linear-gradient(135deg, #ffd700, #ffed4e); color: #2d3748; padding: 20px; border-radius: 15px; text-align: center; font-size: 1.5rem; font-weight: bold; margin: 20px 0; box-shadow: 0 8px 16px rgba(255, 215, 0, 0.3); animation: celebration 1s ease-in-out; }
        @keyframes celebration { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; text-align: center; box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .modal h3 { color: #4a5568; margin-bottom: 20px; font-size: 1.5rem; }
        .modal p { line-height: 1.6; margin-bottom: 20px; color: #718096; }
        .modal-buttons { display: flex; gap: 15px; justify-content: center; }
        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; }
        .btn-primary { background: #4299e1; color: white; }
        .btn-primary:hover { background: #3182ce; transform: translateY(-2px); }
        .btn-secondary { background: #e2e8f0; color: #4a5568; }
        .btn-secondary:hover { background: #cbd5e0; transform: translateY(-2px); }
        .legend { display: flex; justify-content: center; gap: 20px; margin-top: 20px; flex-wrap: wrap; }
        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; }
        .legend-color { width: 20px; height: 20px; border-radius: 4px; border: 1px solid #cbd5e0; }
        .vf-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 20px; }
        .btn-true { background: #48bb78; color: white; }
        .btn-true:hover { background: #38a169; }
        .btn-false { background: #e53e3e; color: white; }
        .btn-false:hover { background: #c53030; }
        @media (max-width: 768px) {
            .game-container { padding: 20px; }
            .game-title { font-size: 2rem; }
            .board { grid-template-columns: repeat(6, 1fr); gap: 6px; padding: 15px; }
            .square { font-size: 0.8rem; padding: 3px; }
            .dice { width: 60px; height: 60px; font-size: 1.5rem; }
        }
        /* Estilo para o Modal de Abertura do V√≠deo */
        #videoModal .modal-content { max-width: 600px; padding: 0; overflow: hidden; }
        #videoModal video { width: 100%; height: auto; display: block; }
        #videoModal .modal-buttons { padding: 20px; background: #f7fafc; }
    </style>
    <style>@view-transition { navigation: auto; }</style>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
    <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
</head>
<body>
    <div class="bubbles">
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div>
    <div class="explosion-overlay" id="explosionOverlay"></div>
    <div class="explosion-particles" id="explosionParticles"></div>
    <div class="stars-celebration" id="starsCelebration"></div>
    <div class="sound-waves" id="soundWaves"></div>
    
    <button class="music-button" id="musicButton" onclick="toggleMusic()">üé∂ Ligar M√∫sica</button>
    
    <div class="modal" id="videoModal" style="display: flex;">
        <div class="modal-content">
            <video id="introVideo" width="100%" height="auto" autoplay loop muted>
                <source src="http://googleusercontent.com/file_content/1000007068.mp4" type="video/mp4">
                Seu navegador n√£o suporta a tag de v√≠deo.
            </video>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="closeVideoModal()">Iniciar Jogo</button>
            </div>
        </div>
    </div>

    <div class="game-container" id="gameContainer" style="display: none;">
        <div class="game-header">
            <h1 class="game-title" id="gameTitle">Tabuleiro Imersivo - Educa√ß√£o Sexual</h1>
            <p class="instructions" id="instructionsText">Clique na roleta para jogar! Respostas certas ganham moedas, erradas ganham bombas!</p>
        </div>
        <div class="players-info">
            <div class="player-card player1 active" id="player1Card">
                <div class="player-name" id="player1Name"> Jogador 1 </div>
                <div>Posi√ß√£o: <span id="player1Position">1</span>/40 </div>
                <div class="player-stats">
                    <div class="stat coins"> ü™ô <span id="player1Coins">0</span> </div>
                    <div class="stat bombs"> üí£ <span id="player1Bombs">0</span> </div>
                </div>
            </div>
            <div class="player-card player2" id="player2Card">
                <div class="player-name" id="player2Name"> Jogador 2 </div>
                <div> Posi√ß√£o:<span id="player2Position">1</span>/40 </div>
                <div class="player-stats">
                    <div class="stat coins"> ü™ô <span id="player2Coins">0</span> </div>
                    <div class="stat bombs"> üí£ <span id="player2Bombs">0</span> </div>
                </div>
            </div>
        </div>
        <div class="game-info">
            <div class="turn-indicator" id="turnIndicator"> Vez do Jogador 1 </div>
        </div>
        <div class="board-container">
            <div class="board" id="gameBoard"></div>
            <div class="roulette-container">
                <div class="roulette" id="roulette" onclick="spinRoulette()">
                    <div class="roulette-pointer"></div>
                    <div class="roulette-center" id="rouletteResult"> üéØ </div>
                </div>
                <div style="text-align: center; color: #4a5568; font-weight: bold;"> üé≤ Clique para rolar o dado! </div>
            </div>
        </div>
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #4299e1, #3182ce);"></div><span>In√≠cio</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #48bb78, #38a169);"></div><span>Verdadeiro/Falso</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #ed8936, #dd6b20);"></div><span>V/F Risco (Especial)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #9f7aea, #805ad5);"></div><span>Fim</span>
            </div>
        </div>
    </div>
    <div class="modal" id="questionModal">
        <div class="modal-content">
            <h3 id="modalTitle">Pergunta</h3>
            <p id="modalQuestion"></p>
            <div id="modalButtons" class="modal-buttons">
                <button class="btn btn-primary" onclick="showAnswer()">Ver Resposta</button> 
            </div>
        </div>
    </div>
    <div class="modal" id="answerModal">
        <div class="modal-content">
            <h3 id="answerTitle">Resposta</h3>
            <p id="answerText"></p>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="closeModal()">Continuar</button>
            </div>
        </div>
    </div>

    <audio id="bgmAudio" src="http://googleusercontent.com/file_content/bgm.mp3" loop></audio>
    <audio id="diceRollAudio" src="http://googleusercontent.com/file_content/dice_roll.ogg"></audio>
    <audio id="moveAudio" src="http://googleusercontent.com/file_content/move.mp3"></audio>
    <audio id="coinAudio" src="http://googleusercontent.com/file_content/coin.wav"></audio>
    <audio id="winAudio" src="http://googleusercontent.com/file_content/win.wav"></audio>

    <script>
        // PERGUNTAS E RESPOSTAS DO JOGO (SOMENTE AS LISTADAS PELO USU√ÅRIO)
        const perguntasInformativas = [
            {"pergunta": "Qual o erro mais comum ao usar um preservativo masculino e como corrigi-lo?", "resposta_correta": "V", "explicacao": "O erro mais comum √© n√£o retirar o ar da ponta do preservativo antes de o desenrolar no p√™nis. Isso pode criar uma bolha de ar que faz com que o preservativo estoure. Basta apertar suavemente a ponta (reservat√≥rio) antes de o colocar."},
            {"pergunta": "Por quanto tempo posso guardar um preservativo na carteira ou no porta-luvas do carro antes que ele se torne inseguro?", "resposta_correta": "F", "explicacao": "O calor e a fric√ß√£o (esfregar na carteira) podem danificar o l√°tex, tornando o preservativo ineficaz. Voc√™ deve guard√°-lo num local fresco, seco e protegido (como um bolso da mochila) e verificar sempre o prazo de validade antes de usar."},
            {"pergunta": "Para que serve o anel externo do preservativo feminino e como se usa?", "resposta_correta": "V", "explicacao": "O anel externo serve para manter o preservativo feminino no lugar fora da vagina (ou √¢nus), cobrindo a vulva/√°rea externa. √â tamb√©m usado para guiar a inser√ß√£o e a remo√ß√£o."},
            {"pergunta": "Al√©m da camisinha masculina, quais s√£o os outros m√©todos contraceptivos que funcionam como 'barreira'?", "resposta_correta": "V", "explicacao": "O preservativo feminino e o diafragma (que precisa ser usado com espermicida) s√£o exemplos de m√©todos de barreira."},
            {"pergunta": "O que √© a 'p√≠lula do dia seguinte' e deve ser usada como m√©todo contraceptivo regular?", "resposta_correta": "F", "explicacao": "√â um contraceptivo de emerg√™ncia que deve ser usado apenas em casos pontuais de falha ou aus√™ncia de outro m√©todo. N√£o deve ser usado como m√©todo contraceptivo regular, pois a sua efic√°cia √© menor do que a p√≠lula di√°ria e a dose hormonal √© muito elevada."},
            {"pergunta": "Existe alguma IST que o preservativo n√£o protege totalmente? Se sim, qual?", "resposta_correta": "V", "explicacao": "Sim. O preservativo protege as √°reas que cobre, mas IST como o HPV (V√≠rus do Papiloma Humano) e o Herpes Genital podem ser transmitidas pelo contato com √°reas da pele infectadas que n√£o est√£o cobertas pelo preservativo."},
            {"pergunta": "Mito ou Verdade: O duche vaginal ap√≥s a rela√ß√£o sexual √© um m√©todo eficaz para prevenir a gravidez e a IST.", "resposta_correta": "F", "explicacao": "Mito. O duche pode na verdade empurrar bact√©rias e v√≠rus para dentro do colo do √∫tero e desequilibra a flora vaginal, aumentando o risco de infec√ß√µes."},
            {"pergunta": "Qual √© o √∫nico m√©todo contraceptivo que oferece prote√ß√£o contra a maioria das Infe√ß√µes Sexualmente Transmiss√≠veis (IST)?", "resposta_correta": "V", "explicacao": "O preservativo (masculino ou feminino) √© o √∫nico m√©todo que oferece dupla prote√ß√£o: contra a gravidez e contra a maioria das IST."},
            {"pergunta": "O que significa 'Consentimento Cont√≠nuo' e por que √© importante?", "resposta_correta": "V", "explicacao": "Significa que o consentimento deve ser dado e confirmado em cada etapa da atividade sexual, podendo ser retirado a qualquer momento. √â crucial porque o consentimento anterior n√£o garante o atual."},
            {"pergunta": "Qual √© a diferen√ßa entre Orienta√ß√£o Sexual e Identidade de G√™nero?", "resposta_correta": "V", "explicacao": "Orienta√ß√£o Sexual √© a atra√ß√£o emocional, rom√¢ntica e/ou sexual por outras pessoas. Identidade de G√™nero √© o sentido interno e individual de ser homem, mulher, ambos, nenhum, ou noutro g√™nero."},
            {"pergunta": "Se uma pessoa n√£o tem sintomas vis√≠veis de IST, significa que n√£o tem a infec√ß√£o? Porqu√™?", "resposta_correta": "F", "explicacao": "N√£o. Muita IST (como Clam√≠dia e HPV) pode ser assintom√°tica durante muito tempo, tornando os testes e o uso de preservativo essenciais mesmo na aus√™ncia de sintomas."},
            {"pergunta": "Na pressa, qual √© o erro mais bobo que pode estragar a camisinha antes mesmo de usar?", "resposta_correta": "F", "explicacao": "Rasgar a embalagem com os dentes ou as unhas. Parece r√°pido, mas um microfuro invis√≠vel j√° anula a prote√ß√£o. Dica: Sempre use os dedos para rasgar o sach√™ na borda serrilhada. Aten√ß√£o: Guarde a camisinha em locais frescos, longe do calor (nada de porta-luvas do carro ou carteira apertada) para n√£o danificar o material."},
            {"pergunta": "Qual lado √© o certo para desenrolar e o que fazer se colocar no lado errado?", "resposta_correta": "V", "explicacao": "O lado certo √© aquele em que a borda est√° para fora, parecendo um pequeno chap√©u. Se voc√™ tentar desenrolar e ela n√£o descer facilmente, √© porque est√° do lado errado. Regra de Ouro: Se come√ßou a desenrolar do lado errado e tocou no p√™nis, jogue fora e pegue outra! Fluidos pr√©-ejaculat√≥rios (que j√° podem ter IST e espermatozoides) podem ter entrado em contato com a parte de dentro."},
            {"pergunta": "Por que √© crucial apertar a pontinha (o 'bico') antes de desenrolar?", "resposta_correta": "V", "explicacao": "Aquela pontinha √© o reservat√≥rio do esperma. Se n√£o apertar para tirar o ar, o ar fica preso. Na hora da ejacula√ß√£o, a press√£o pode ser tanta que o preservativo estoura. O que fazer: Segure a pontinha (reservat√≥rio) com dois dedos para tirar o ar. Mantenha os dedos ali enquanto apoia a camisinha na cabe√ßa do p√™nis ereto."},
            {"pergunta": "Tenho que desenrolar at√© o final, at√© a base?", "resposta_correta": "V", "explicacao": "Sim, totalmente! A camisinha s√≥ protege se cobrir o p√™nis por inteiro, da cabe√ßa at√© a base. √â ali, na base, que a borda forma uma 'barra' que ajuda a prender o esperma. Como fazer: Depois de apertar a ponta, use o dedo que sobrou (ou a outra m√£o) para desenrolar a camisinha completamente at√© a raiz do p√™nis."},
            {"pergunta": "Na hora de tirar, como garantir que n√£o vai vazar nada?", "resposta_correta": "V", "explicacao": "Voc√™ precisa ser r√°pido e cuidadoso imediatamente ap√≥s a ejacula√ß√£o, antes que o p√™nis comece a ficar mole. Passo 1: Segure a borda da camisinha na base do p√™nis. Passo 2: Retire o p√™nis devagar da vagina ou do √¢nus. Passo 3: Retire a camisinha e jogue no lixo. (Nunca no vaso sanit√°rio, pois entope)."},
            {"pergunta": "Posso colocar a camisinha feminina com anteced√™ncia?", "resposta_correta": "V", "explicacao": "Sim, e essa √© uma das grandes vantagens! Voc√™ pode colocar o preservativo feminino horas antes da rela√ß√£o sexual. Isso tira a press√£o do momento e garante que a preven√ß√£o j√° est√° pronta. Como saber que est√° pronto: O anel maior deve estar para fora da vagina (ou √¢nus), cobrindo a entrada, e o anel menor deve estar bem fundo, l√° dentro."},
            {"pergunta": "O anel menor precisa ficar muito fundo? Como coloco?", "resposta_correta": "V", "explicacao": "Sim, o anel menor √© quem prende a camisinha l√° dentro. Voc√™ deve apert√°-lo com os dedos, como se fosse um absorvente interno, e empurr√°-lo o mais fundo que conseguir. Posi√ß√£o: Escolha a posi√ß√£o mais f√°cil: agachada, deitada ou com uma perna apoiada em algum lugar. O que √© normal: √â normal que o preservativo fique frouxo ou meio torcido dentro do canal. Essa folga √© normal e permite que ele se ajuste."},
            {"pergunta": "Como garantir que o p√™nis vai entrar dentro da camisinha e n√£o ao lado?", "resposta_correta": "V", "explicacao": "O anel externo (o anel maior) √© a sua garantia. Ele fica para fora, cobrindo a entrada da vagina ou √¢nus. Ele funciona como um 'guia' para o p√™nis. Dica: Voc√™ pode usar um pouco de lubrificante (√† base de √°gua ou silicone) na parte de fora para que a penetra√ß√£o seja mais suave e n√£o corra o risco do p√™nis escorregar para o lado."},
            {"pergunta": "O que NUNCA posso fazer com o preservativo feminino?", "resposta_correta": "F", "explicacao": "NUNCA use a camisinha interna e a camisinha externa ao mesmo tempo! O atrito entre os dois materiais pode rasgar as duas camisinhas. Escolha um ou outro."},
            {"pergunta": "Como tirar sem fazer bagun√ßa?", "resposta_correta": "V", "explicacao": "Voc√™ deve torcer o anel externo que est√° para fora. Isso 'fecha' a bolsa e prende o s√™men l√° dentro. Depois, √© s√≥ puxar com cuidado. Descarte: Sempre jogue no lixo, embrulhado num pedacinho de papel higi√™nico para descartar de forma discreta."},
            {"pergunta": "Qual √© a import√¢ncia da comunica√ß√£o e do consentimento em todas as rela√ß√µes sexuais?", "resposta_correta": "V", "explicacao": "A comunica√ß√£o aberta e o consentimento s√£o a base de qualquer rela√ß√£o sexual saud√°vel e respeitosa. O consentimento deve ser claro, entusi√°stico e pode ser retirado a qualquer momento. √â essencial para garantir que ambos os parceiros se sintam seguros e confort√°veis, e para prevenir abusos."},
            {"pergunta": "Qual √© a diferen√ßa entre libido e desejo sexual?", "resposta_correta": "V", "explicacao": "Libido √© o termo geral para o impulso sexual ou energia sexual de uma pessoa. O desejo sexual, por outro lado, √© a vontade espec√≠fica de ter atividade sexual. A libido √© mais como o 'motor', enquanto o desejo √© a 'vontade de dirigir'."},
            {"pergunta": "O que √© 'sexting' e quais os riscos associados se n√£o for feito com consentimento e seguran√ßa?", "resposta_correta": "V", "explicacao": "Sexting √© o ato de enviar mensagens, fotos ou v√≠deos de natureza sexual expl√≠cita. Os riscos incluem a exposi√ß√£o e a distribui√ß√£o n√£o consensual do conte√∫do (pornografia de vingan√ßa), que √© ilegal e pode ter graves consequ√™ncias emocionais e legais."},
            {"pergunta": "Explique brevemente o conceito de 'Zona de Conforto' na sexualidade.", "resposta_correta": "V", "explicacao": "Na sexualidade, a 'Zona de Conforto' refere-se √†s pr√°ticas, fantasias e n√≠veis de intimidade com os quais uma pessoa se sente segura, √† vontade e excitada. Explorar fora dessa zona com um parceiro requer comunica√ß√£o, confian√ßa e consentimento m√∫tuo."}
        ];

        const perguntasRisco = [
            {"pergunta": "Verdade ou Mito: Esquecer a p√≠lula anticoncepcional num dia, mas tom√°-la no dia seguinte, anula completamente o risco de gravidez.", "resposta_correta": "F", "explicacao": "A efic√°cia da p√≠lula depende da tomada correta e di√°ria. Se voc√™ falhar um dia, a prote√ß√£o pode ser reduzida, e m√©todos de prote√ß√£o adicionais (como o preservativo) devem ser usados nos dias seguintes, conforme as indica√ß√µes m√©dicas."},
            {"pergunta": "√â seguro usar dois preservativos ao mesmo tempo para maior prote√ß√£o.", "resposta_correta": "F", "explicacao": "Usar dois preservativos aumenta o atrito entre eles, fazendo com que ambos se rasguem mais facilmente. Use sempre apenas um preservativo de cada vez."},
            {"pergunta": "A p√≠lula do dia seguinte pode ser usada como m√©todo contraceptivo regular.", "resposta_correta": "F", "explicacao": "A p√≠lula do dia seguinte √© apenas para emerg√™ncias. Usar regularmente pode causar desequil√≠brios hormonais e √© menos eficaz que m√©todos contraceptivos regulares."},
            {"pergunta": "√â poss√≠vel engravidar mesmo usando preservativo corretamente.", "resposta_correta": "V", "explicacao": "Nenhum m√©todo contraceptivo √© 100% eficaz. O preservativo tem cerca de 98% de efic√°cia quando usado corretamente, mas ainda existe uma pequena possibilidade de falha."},
            {"pergunta": "Toda IST apresenta sintomas vis√≠veis.", "resposta_correta": "F", "explicacao": "Muita IST (como Clam√≠dia, HPV e HIV) pode ser assintom√°tica por longos per√≠odos. Por isso √© importante fazer testes regulares e usar sempre preservativo."},
            {"pergunta": "O preservativo protege contra toda IST.", "resposta_correta": "F", "explicacao": "O preservativo protege contra a maioria das IST, mas algumas como HPV e Herpes podem ser transmitidas pelo contato com √°reas da pele n√£o cobertas pelo preservativo."},
            {"pergunta": "Lubrificantes √† base de √≥leo s√£o seguros para usar com preservativos de l√°tex.", "resposta_correta": "F", "explicacao": "Lubrificantes √† base de √≥leo (como vaselina ou √≥leos de massagem) podem danificar o l√°tex do preservativo, tornando-o menos eficaz e mais propenso a rasgar. Use sempre lubrificantes √† base de √°gua ou silicone com preservativos de l√°tex."},
            {"pergunta": "√â poss√≠vel engravidar tendo rela√ß√£o sexual durante a menstrua√ß√£o.", "resposta_correta": "V", "explicacao": "Embora a probabilidade seja menor, espermatozoides podem sobreviver por v√°rios dias no corpo feminino, e a ovula√ß√£o pode ocorrer mais cedo em alguns ciclos, levando √† gravidez. Sempre use prote√ß√£o se n√£o deseja engravidar."},
            {"pergunta": "IST √© um problema de sa√∫de apenas para pessoas sexualmente ativas com m√∫ltiplos parceiros.", "resposta_correta": "F", "explicacao": "Qualquer pessoa sexualmente ativa pode contrair uma IST, independentemente do n√∫mero de parceiros. O risco est√° na pr√°tica sexual desprotegida."},
            {"pergunta": "O sexo anal √© uma pr√°tica de baixo risco para a transmiss√£o de IST em compara√ß√£o com o sexo vaginal.", "resposta_correta": "F", "explicacao": "O sexo anal √©, na verdade, uma pr√°tica de alto risco para a transmiss√£o de IST (incluindo o HIV) devido √† maior fragilidade do tecido anal, que pode sofrer microles√µes mais facilmente. O uso correto do preservativo e lubrificante √© essencial."}
        ];

        // Mapeamento dos NOVOS arquivos de imagem
        const characterImages = {
            'boy_q': 'http://googleusercontent.com/file_content/1000007040.png', // Garoto Pensativo
            'boy_a': 'http://googleusercontent.com/file_content/1000007043.png', // Garoto Acerto
            'boy_e': 'http://googleusercontent.com/file_content/1000007046.png', // Garoto Erro
            
            'girl_q': 'http://googleusercontent.com/file_content/1000007042.png', // Garota Pensativa/Ideia
            'girl_a': 'http://googleusercontent.com/file_content/1000007044.png', // Garota Acerto
            'girl_e': 'http://googleusercontent.com/file_content/1000007045.png', // Garota Erro
        };

        // Elementos de √Åudio
        const bgmAudio = document.getElementById('bgmAudio');
        const diceRollAudio = document.getElementById('diceRollAudio');
        const moveAudio = document.getElementById('moveAudio');
        const coinAudio = document.getElementById('coinAudio');
        const winAudio = document.getElementById('winAudio');

        // Estado do jogo
        let gameState = {
            currentPlayer: 1,
            players: {
                1: { position: 1, coins: 0, bombs: 0 },
                2: { position: 1, coins: 0, bombs: 0 }
            },
            gameEnded: false,
            musicPlaying: false
        };
        let currentQuestion = null;
        let currentQuestionType = null;

        // Configura√ß√£o padr√£o
        const defaultConfig = {
            game_title: "Tabuleiro Imersivo - Educa√ß√£o Sexual",
            player1_name: "Jogador 1",
            player2_name: "Jogador 2",
            instructions_text: "Clique na roleta para jogar! Respostas certas ganham moedas, erradas ganham bombas!"
        };

        // --- Fun√ß√µes de √Åudio e Efeitos Visuais ---

        function playSound(audioElement, volume = 1.0) {
            audioElement.currentTime = 0;
            audioElement.volume = volume;
            audioElement.play().catch(e => console.log("Erro ao reproduzir √°udio:", e));
        }

        function toggleMusic() {
            const button = document.getElementById('musicButton');
            gameState.musicPlaying = !gameState.musicPlaying;
            if (gameState.musicPlaying) {
                button.textContent = 'üéµ M√∫sica Ligada';
                button.classList.add('playing');
                playSound(bgmAudio, 0.4); 
                createSoundWaves(button, '#667eea', 3);
            } else {
                button.textContent = 'üé∂ Ligar M√∫sica';
                button.classList.remove('playing');
                bgmAudio.pause();
            }
        }

        function closeVideoModal() {
            document.getElementById('videoModal').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'block';
            document.getElementById('introVideo').pause();
            document.getElementById('introVideo').currentTime = 0;
        }

        function createSoundWaves(element, color, count = 1) {
            const container = document.getElementById('soundWaves');
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            for (let i = 0; i < count; i++) {
                const wave = document.createElement('div');
                wave.className = 'sound-wave';
                wave.style.borderColor = color;
                wave.style.left = (centerX - 10) + 'px';
                wave.style.top = (centerY - 10) + 'px';
                wave.style.animationDelay = (i * 0.3) + 's';
                container.appendChild(wave);
                setTimeout(() => { if (container.contains(wave)) { container.removeChild(wave); } }, 1500 + (i * 300));
            }
        }
        function createDiceVisualEffect() {
            const effect = document.createElement('div');
            effect.className = 'dice-visual-effect';
            effect.textContent = 'üé≤';
            document.body.appendChild(effect);
            setTimeout(() => { if (document.body.contains(effect)) { document.body.removeChild(effect); } }, 1000);
        }
        function createMoveTrail(fromElement, toElement) {
            const fromRect = fromElement.getBoundingClientRect();
            const toRect = toElement.getBoundingClientRect();
            const steps = 8;
            for (let i = 0; i < steps; i++) {
                setTimeout(() => {
                    const trail = document.createElement('div');
                    trail.className = 'move-trail';
                    const progress = i / (steps - 1);
                    const x = fromRect.left + (toRect.left - fromRect.left) * progress;
                    const y = fromRect.top + (toRect.top - fromRect.top) * progress;
                    trail.style.left = x + 'px';
                    trail.style.top = y + 'px';
                    document.body.appendChild(trail);
                    setTimeout(() => { if (document.body.contains(trail)) { document.body.removeChild(trail); } }, 1000);
                }, i * 100);
            }
        }
        function createCoinVisualEffect() {
            const effect = document.createElement('div');
            effect.className = 'coin-visual-effect';
            effect.textContent = 'ü™ô';
            document.body.appendChild(effect);
            setTimeout(() => { if (document.body.contains(effect)) { document.body.removeChild(effect); } }, 2000);
        }
        function createErrorVisualEffect() {
            const effect = document.createElement('div');
            effect.className = 'error-visual-effect';
            effect.textContent = 'üí•';
            document.body.appendChild(effect);
            setTimeout(() => { if (document.body.contains(effect)) { document.body.removeChild(effect); } }, 1500);
        }
        function createVictoryVisualEffect() {
            const effect = document.createElement('div');
            effect.className = 'victory-visual-effect';
            effect.textContent = 'üèÜ';
            document.body.appendChild(effect);
            setTimeout(() => { if (document.body.contains(effect)) { document.body.removeChild(effect); } }, 3000);
        }
        function createExplosion() {
            const overlay = document.getElementById('explosionOverlay');
            const particlesContainer = document.getElementById('explosionParticles');
            const gameContainer = document.querySelector('.game-container');
            overlay.style.display = 'block';
            gameContainer.classList.add('screen-shake');
            particlesContainer.innerHTML = '';
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                const angle = (i / 20) * 2 * Math.PI;
                const distance = Math.random() * 200 + 50;
                const x = Math.cos(angle) * distance;
                const y = Math.sin(angle) * distance;
                particle.style.setProperty('--end-x', `${x}px`);
                particle.style.setProperty('--end-y', `${y}px`);
                particle.style.animation = `particle-explosion 1.5s ease-out forwards`;
                particle.style.animationDelay = `${Math.random() * 0.3}s`;
                const colors = ['#ff4500', '#ff6b00', '#ff8c00', '#ffa500', '#ffb347'];
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                particlesContainer.appendChild(particle);
            }
            setTimeout(() => {
                overlay.style.display = 'none';
                gameContainer.classList.remove('screen-shake');
                particlesContainer.innerHTML = '';
            }, 1500);
        }
        function createStarsCelebration() {
            const starsContainer = document.getElementById('starsCelebration');
            starsContainer.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                const star = document.createElement('div');
                star.className = 'dancing-star';
                const starTypes = ['‚≠ê', '‚ú®', 'üåü', 'üí´', '‚ö°'];
                star.textContent = starTypes[Math.floor(Math.random() * starTypes.length)];
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 0.8 + 's';
                const scale = 0.8 + Math.random() * 0.4;
                star.style.transform = `scale(${scale})`;
                starsContainer.appendChild(star);
                for (let j = 0; j < 2; j++) {
                    const trail = document.createElement('div');
                    trail.className = 'star-trail';
                    trail.style.left = (parseFloat(star.style.left) + (Math.random() - 0.5) * 10) + '%';
                    trail.style.top = (parseFloat(star.style.top) + (Math.random() - 0.5) * 10) + '%';
                    trail.style.animationDelay = (Math.random() * 0.5 + 0.3) + 's';
                    starsContainer.appendChild(trail);
                }
            }
            for (let i = 0; i < 8; i++) {
                const comet = document.createElement('div');
                comet.className = 'flying-comet';
                comet.textContent = '‚òÑÔ∏è';
                let startX, startY, endX, endY;
                const side = Math.floor(Math.random() * 4);
                switch(side) {
                    case 0: startX = Math.random() * 100; startY = -10; endX = Math.random() * 100; endY = 110; break;
                    case 1: startX = 110; startY = Math.random() * 100; endX = -10; endY = Math.random() * 100; break;
                    case 2: startX = Math.random() * 100; startY = 110; endX = Math.random() * 100; endY = -10; break;
                    case 3: startX = -10; startY = Math.random() * 100; endX = 110; endY = Math.random() * 100; break;
                }
                comet.style.left = startX + '%';
                comet.style.top = startY + '%';
                comet.style.setProperty('--end-x', endX + '%');
                comet.style.setProperty('--end-y', endY + '%');
                comet.style.animationDelay = Math.random() * 1 + 's';
                starsContainer.appendChild(comet);
                const cometTrail = document.createElement('div');
                cometTrail.className = 'comet-trail';
                cometTrail.style.left = startX + '%';
                cometTrail.style.top = startY + '%';
                cometTrail.style.setProperty('--trail-end-x', endX + '%');
                cometTrail.style.setProperty('--trail-end-y', endY + '%');
                cometTrail.style.animationDelay = Math.random() * 1 + 's';
                starsContainer.appendChild(cometTrail);
            }
            setTimeout(() => { starsContainer.innerHTML = ''; }, 4000);
        }

        // --- Fun√ß√µes de Jogo ---

        function initializeBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            const radius = 250; 
            const centerX = 300; 
            const centerY = 300; 
            for (let i = 1; i <= 40; i++) {
                const square = document.createElement('div');
                square.className = 'square';
                square.id = `square-${i}`;
                const angle = ((i - 1) / 40) * 2 * Math.PI - Math.PI / 2; 
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);
                square.style.left = `${x - 40}px`; 
                square.style.top = `${y - 50}px`; 
                square.style.animationDelay = `${i * 0.1}s`; 
                if (i === 1) {
                    square.classList.add('start');
                    const character = document.createElement('div');
                    character.className = 'square-character';
                    character.textContent = 'üöÄ';
                    const label = document.createElement('div');
                    label.className = 'square-number';
                    label.textContent = 'IN√çCIO';
                    square.appendChild(character);
                    square.appendChild(label);
                } else if (i === 40) {
                    square.classList.add('finish');
                    const character = document.createElement('div');
                    character.className = 'square-character';
                    character.textContent = 'üèÜ';
                    const label = document.createElement('div');
                    label.className = 'square-number';
                    label.textContent = 'FIM';
                    square.appendChild(character);
                    square.appendChild(label);
                } else if (i % 5 === 0 || i % 7 === 0) {
                    square.classList.add('vf');
                    const character = document.createElement('div');
                    character.className = 'square-character';
                    character.textContent = i % 2 === 0 ? 'üëß' : 'üë¶';
                    const label = document.createElement('div');
                    label.className = 'square-number';
                    label.textContent = 'V/F Risco';
                    square.appendChild(character);
                    square.appendChild(label);
                } else {
                    square.classList.add('normal');
                    const character = document.createElement('div');
                    character.className = 'square-character';
                    character.textContent = i % 2 === 0 ? 'üëß' : 'üë¶';
                    const label = document.createElement('div');
                    label.className = 'square-number';
                    label.textContent = i;
                    square.appendChild(character);
                    square.appendChild(label);
                }
                if (i !== 1 && i !== 40) {
                    const characterCard = document.createElement('div');
                    characterCard.className = 'character-card';
                    characterCard.id = `character-${i}`;
                    const avatar = document.createElement('div');
                    avatar.className = 'character-avatar has-image';
                    const isGirl = i % 2 === 0;
                    const defaultImage = isGirl ? characterImages.girl_q : characterImages.boy_q;
                    avatar.style.backgroundImage = `url(${defaultImage})`;
                    const message = document.createElement('div');
                    message.className = 'character-message';
                    message.textContent = 'Boa sorte!';
                    characterCard.appendChild(avatar);
                    message.textContent = 'Boa sorte!';
                    characterCard.appendChild(message);
                    square.appendChild(characterCard);
                }
                if (i === 1) {
                    const player1 = document.createElement('div');
                    player1.className = 'player player1';
                    player1.textContent = '1';
                    square.appendChild(player1);
                    const player2 = document.createElement('div');
                    player2.className = 'player player2';
                    player2.textContent = '2';
                    square.appendChild(player2);
                }
                board.appendChild(square);
            }
        }

        function spinRoulette() {
            if (gameState.gameEnded) return;
            const roulette = document.getElementById('roulette');
            const result = document.getElementById('rouletteResult');
            playSound(diceRollAudio, 0.7);
            createDiceVisualEffect();
            createSoundWaves(roulette, '#ffd700', 2);
            roulette.classList.add('spinning', 'roulette-glow');
            setTimeout(() => {
                const roll = Math.floor(Math.random() * 6) + 1;
                result.textContent = roll;
                roulette.classList.remove('spinning', 'roulette-glow');
                movePlayer(roll);
            }, 2000);
        }

        function movePlayer(steps) {
            const player = gameState.players[gameState.currentPlayer];
            const oldPosition = player.position;
            const currentSquare = document.getElementById(`square-${oldPosition}`);
            const playerElement = currentSquare.querySelector(`.player.player${gameState.currentPlayer}`);
            player.position = Math.min(player.position + steps, 40);
            const newSquare = document.getElementById(`square-${player.position}`);

            if (playerElement) {
                createMoveTrail(currentSquare, newSquare);
                playSound(moveAudio, 0.5);
                playerElement.remove();
            }

            const newPlayer = document.createElement('div');
            newPlayer.className = `player player${gameState.currentPlayer} player-move-glow`;
            newPlayer.textContent = gameState.currentPlayer;
            newPlayer.style.transform = 'scale(0)';
            newSquare.appendChild(newPlayer);
            
            setTimeout(() => {
                newPlayer.style.transform = 'scale(1)';
                newPlayer.style.transition = 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
            }, 100);

            updatePlayerDisplay();

            if (player.position === 40) {
                gameState.gameEnded = true;
                const playerName = gameState.currentPlayer === 1 ? 
                    (document.getElementById('player1Name').textContent || 'Jogador 1') : 
                    (document.getElementById('player2Name').textContent || 'Jogador 2');
                setTimeout(() => {
                    playSound(winAudio);
                    createVictoryVisualEffect();
                    showWinner(playerName);
                }, 500);
                return;
            }

            setTimeout(() => {
                const square = document.getElementById(`square-${player.position}`);
                // 50% chance de cair na pergunta informativa se for casa normal, sen√£o vai para V/F Risco
                if (square.classList.contains('normal')) {
                    showCharacterCard(player.position);
                    showInformativeQuestion();
                } else if (square.classList.contains('vf')) {
                    showCharacterCard(player.position);
                    showVFQuestion();
                } else {
                    if (!gameState.gameEnded) {
                        switchPlayer();
                    }
                }
            }, 500);
        }

        function updatePlayerDisplay() {
            const player1 = gameState.players[1];
            const player2 = gameState.players[2];
            document.getElementById('player1Position').textContent = player1.position;
            document.getElementById('player1Coins').textContent = player1.coins;
            document.getElementById('player1Bombs').textContent = player1.bombs;
            document.getElementById('player2Position').textContent = player2.position;
            document.getElementById('player2Coins').textContent = player2.coins;
            document.getElementById('player2Bombs').textContent = player2.bombs;
            const player1Card = document.getElementById('player1Card');
            const player2Card = document.getElementById('player2Card');
            const turnIndicator = document.getElementById('turnIndicator');
            if (gameState.currentPlayer === 1) {
                player1Card.classList.add('active');
                player2Card.classList.remove('active');
                turnIndicator.textContent = `Vez do ${document.getElementById('player1Name').textContent || 'Jogador 1'}`;
            } else {
                player1Card.classList.remove('active');
                player2Card.classList.add('active');
                turnIndicator.textContent = `Vez do ${document.getElementById('player2Name').textContent || 'Jogador 2'}`;
            }
        }

        function switchPlayer() {
            gameState.currentPlayer = gameState.currentPlayer === 1 ? 2 : 1;
            updatePlayerDisplay();
        }

        function showWinner(playerName) {
            const winnerDiv = document.createElement('div');
            winnerDiv.className = 'winner-announcement';
            winnerDiv.innerHTML = `üéâ ${playerName} VENCEU! üéâ<br>Parab√©ns por completar o tabuleiro de educa√ß√£o sexual!`;
            const gameInfo = document.querySelector('.game-info');
            gameInfo.appendChild(winnerDiv);

            setTimeout(() => {
                showCustomModal('üèÜ Fim de Jogo!', `${playerName} chegou primeiro ao final! Parab√©ns por aprender sobre educa√ß√£o sexual de forma divertida!`, [
                    {text: 'Jogar Novamente', action:() => { 
                        gameState = { 
                            currentPlayer: 1, 
                            players: { 
                                1: { position: 1, coins: 0, bombs: 0 }, 
                                2: { position: 1, coins: 0, bombs: 0 } 
                            }, 
                            gameEnded: false, 
                            musicPlaying: gameState.musicPlaying 
                        }; 
                        initializeBoard(); 
                        updatePlayerDisplay(); 
                        winnerDiv.remove(); 
                        closeModal(); 
                    }}
                ]);
            }, 2000);
        }

        function showInformativeQuestion() {
            const randomIndex = Math.floor(Math.random() * perguntasInformativas.length);
            currentQuestion = perguntasInformativas[randomIndex];
            currentQuestionType = 'informative';
            document.getElementById('modalTitle').textContent = 'Pergunta Informativa'; // T√≠tulo gen√©rico, pois as perguntas s√£o de temas diversos
            document.getElementById('modalQuestion').textContent = currentQuestion.pergunta;
            // Para as perguntas informativas, o jogador clica para ver a resposta/explica√ß√£o
            document.getElementById('modalButtons').innerHTML = `
                <button class="btn btn-primary" onclick="showAnswerAndContinue()">Ver Resposta</button>
            `;
            document.getElementById('questionModal').style.display = 'flex';
        }

        function showVFQuestion() {
            const randomIndex = Math.floor(Math.random() * perguntasRisco.length);
            currentQuestion = perguntasRisco[randomIndex];
            currentQuestionType = 'vf';
            document.getElementById('modalTitle').textContent = 'Pergunta de Risco: Verdadeiro ou Falso?';
            document.getElementById('modalQuestion').textContent = currentQuestion.pergunta;
            document.getElementById('modalButtons').innerHTML = `
                <div class="vf-buttons">
                    <button class="btn btn-true" onclick="checkVFAnswer('V')">Verdadeiro</button>
                    <button class="btn btn-false" onclick="checkVFAnswer('F')">Falso</button>
                </div>
            `;
            document.getElementById('questionModal').style.display = 'flex';
        }

        function showCharacterCard(position) {
            const characterCard = document.getElementById(`character-${position}`);
            if (characterCard) {
                characterCard.classList.add('show');
            }
        }

        function updateCharacterReaction(position, isCorrect) {
            const characterCard = document.getElementById(`character-${position}`);
            if (characterCard) {
                const avatar = characterCard.querySelector('.character-avatar');
                const message = characterCard.querySelector('.character-message');
                const isGirl = position % 2 === 0;
                let imageFile;

                characterCard.classList.remove('happy', 'sad');
                message.classList.remove('happy', 'sad');

                if (isCorrect) {
                    imageFile = isGirl ? characterImages.girl_a : characterImages.boy_a;
                    message.textContent = 'Parab√©ns! Acerto! üòä';
                    characterCard.classList.add('happy');
                    message.classList.add('happy');
                } else {
                    imageFile = isGirl ? characterImages.girl_e : characterImages.boy_e;
                    message.textContent = 'Que pena! Erro! üòî';
                    characterCard.classList.add('sad');
                    message.classList.add('sad');
                }

                avatar.style.backgroundImage = `url(${imageFile})`;

                setTimeout(() => {
                    characterCard.classList.remove('happy', 'sad');
                    message.classList.remove('happy', 'sad');
                    message.textContent = 'Boa sorte!';
                    avatar.style.backgroundImage = `url(${isGirl ? characterImages.girl_q : characterImages.boy_q})`;
                }, 5000);
            }
        }

        // Fun√ß√£o ajustada para Perguntas de Risco (V/F)
        function checkVFAnswer(answer) {
            const isCorrect = answer === currentQuestion.resposta_correta;
            const player = gameState.players[gameState.currentPlayer];
            
            updateCharacterReaction(player.position, isCorrect);
            
            if (isCorrect) {
                player.coins++;
                document.getElementById('answerTitle').textContent = '‚úÖ Correto! +1 Moeda';
                playSound(coinAudio, 0.8);
                setTimeout(() => {
                    createCoinVisualEffect();
                    createStarsCelebration();
                }, 500);
            } else {
                player.bombs++;
                document.getElementById('answerTitle').textContent = '‚ùå Erro Grave! +1 Bomba';
                // Penalidade do jogo 1: Volta ao in√≠cio.
                player.position = 1; 
                setTimeout(() => {
                    createErrorVisualEffect();
                    createExplosion();
                    initializeBoard(); // Redesenha para mover o pe√£o
                }, 500);
            }
            
            document.getElementById('answerText').textContent = currentQuestion.explicacao;
            updatePlayerDisplay();
            
            document.getElementById('questionModal').style.display = 'none';
            document.getElementById('answerModal').style.display = 'flex';
        }

        // Nova fun√ß√£o para mostrar resposta de perguntas informativas e continuar
        function showAnswerAndContinue() {
            document.getElementById('questionModal').style.display = 'none';
            document.getElementById('answerTitle').textContent = 'Aprenda Mais!';
            document.getElementById('answerText').textContent = currentQuestion.explicacao;
            
            // Rea√ß√£o neutra, pois √© informativa, n√£o acerto/erro
            const player = gameState.players[gameState.currentPlayer];
            const isGirl = player.position % 2 === 0;
            const characterCard = document.getElementById(`character-${player.position}`);
            const avatar = characterCard.querySelector('.character-avatar');
            const message = characterCard.querySelector('.character-message');

            characterCard.classList.remove('happy', 'sad');
            message.classList.remove('happy', 'sad');
            message.textContent = 'Conhecimento √© poder! üí°';
            avatar.style.backgroundImage = `url(${isGirl ? characterImages.girl_q : characterImages.boy_q})`;

            document.getElementById('answerModal').style.display = 'flex';
        }


        function closeModal() {
            document.getElementById('questionModal').style.display = 'none';
            document.getElementById('answerModal').style.display = 'none';
            if (!gameState.gameEnded) {
                switchPlayer();
            }
        }

        function showCustomModal(title, message, buttons) {
            document.getElementById('answerTitle').textContent = title;
            document.getElementById('answerText').textContent = message;
            const buttonContainer = document.querySelector('#answerModal .modal-buttons');
            buttonContainer.innerHTML = '';
            buttons.forEach(button => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-primary';
                btn.textContent = button.text;
                btn.onclick = button.action;
                buttonContainer.appendChild(btn);
            });
            document.getElementById('answerModal').style.display = 'flex';
        }

        // Configura√ß√£o do Element SDK
        async function render(config) {
            const gameTitle = config.game_title || defaultConfig.game_title;
            const player1Name = config.player1_name || defaultConfig.player1_name;
            const player2Name = config.player2_name || defaultConfig.player2_name;
            const instructionsText = config.instructions_text || defaultConfig.instructions_text;

            document.getElementById('gameTitle').textContent = gameTitle;
            document.getElementById('player1Name').textContent = player1Name;
            document.getElementById('player2Name').textContent = player2Name;
            document.getElementById('instructionsText').textContent = instructionsText;
            updatePlayerDisplay();
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    { get: () => config.primary_color || '#4299e1', set: (value) => { config.primary_color = value; if (window.elementSdk) { window.elementSdk.setConfig({ primary_color: value }); } } }
                ],
                borderables: [],
                fontEditable: { get: () => config.font_family || 'Segoe UI', set: (value) => { config.font_family = value; if (window.elementSdk) { window.elementSdk.setConfig({ font_family: value }); } } },
                fontSizeable: { get: () => config.font_size || 16, set: (value) => { config.font_size = value; if (window.elementSdk) { window.elementSdk.setConfig({ font_size: value }); } } }
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["game_title", config.game_title || defaultConfig.game_title],
                ["player1_name", config.player1_name || defaultConfig.player1_name],
                ["player2_name", config.player2_name || defaultConfig.player2_name],
                ["instructions_text", config.instructions_text || defaultConfig.instructions_text]
            ]);
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            initializeBoard();
            updatePlayerDisplay();

            bgmAudio.load();
            diceRollAudio.load();
            moveAudio.load();
            coinAudio.load();
            winAudio.load();
            
            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    render,
                    mapToCapabilities,
                    mapToEditPanelValues
                });
            }
        });
    </script>
</body>
</html>
